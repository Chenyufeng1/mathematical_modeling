function  [h_min,err_min]=RFE_Relief(M,h,M_average,M_stdd)
%找到决定分类的最小数量的基因组
%  Author : LIU Chao  
%  e-mail : liuchao-will@163.com
%  School of Computer Science and Technology,Southeast
%  University,China,Sept.2010  
err=svm_process(M);
h_gab={};
err_gab=[];
i=1;
while ~isempty(h)
    err_gab(i)=err;
    [M,h,M_average_sorted,M_stdd_sorted]=relief(M,h,M_average,M_stdd);    
    h_gab(i)=h(length(h));
    [r,c]=size(M);
%     if c==3
%         M3=M;
%         M3_average=M_average_sorted;
%         M3_stdd=M_stdd_sorted;
%     end
    M(:,c)=[];
    h(length(h))=[];
    err=svm_process(M);
    i=i+1;
end
% 这时M是空矩阵 62 by 1
% err3=svm_process(M3)
% kmeans(M3,2)
% err_gab
err_min=min(err_gab);
h_min=h_gab(max(find(err_gab==min(err_gab))):length(h_gab));
    



% A=M;
% geneW=[];   
% i=1;
% while ~isempty(A)
%     [W_new,index]=relief(A);
%     [r,c]=size(A);
%     if index(length(index))==1
%          A=A(:,2:c);
%     elseif index(length(index))==c
%          A=A(:,1:c-1);
%     else
%         A=A(:,1:index(length(index))-1,index(length(index))+1:c);%去掉权值最小的一列
%     end
%     
%     if isempty(geneW)
%         geneW(i)=index(length(index));
%     else
%         if index(length(index))<min(geneW(1:i-1))
%             geneW(i)=index(length(index));
%         else
%             
%             
%         
%     i=i+1;
%     
%     
%     
%     
% end